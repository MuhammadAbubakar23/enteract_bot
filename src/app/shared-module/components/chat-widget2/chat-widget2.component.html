<body class="agent-grid leftactive">
  <main>
    <div class="main-wrapper d-flex">
      <div class="middle-wrapper d-flex w-100 flex-column">
        <div class="content-box-wrapper d-flex w-100">
          <div class="middle-content d-flex">
            <div
              *ngIf="!hasParent"
              class="chatbg"
              style="
                background: url(../../../../assets/images/chatbg.png) no-repeat
                  top;
              "
            ></div>
            <div class="e-bot-icon" [ngClass]="{ active: isOpen }">
              <div class="e_chat-icon" (click)="openChat()">
                <img src="../../../../assets/Images/ebot.svg" />
              </div>
            </div>
            <div
              class="enteract-chatbot"
              [ngClass]="{ active: isOpen, removebot: !isOpen }"
            >
              <div class="e-chat-main">
                <header>
                  <div class="e_chat-icon">
                    <img src="../../../../assets/Images/ebot.svg" />
                  </div>
                  <div>
                    <h4>enteract.bot</h4>
                    <p class="coal">Online</p>
                  </div>
                  <div class="ebotclose mt-2" (click)="closeChat()">
                    <i class="fa-light fa-minus"></i>
                  </div>
                </header>
                <section class="chatbody" #chatBody  style="overflow: auto;" #scrollMe [scrollTop]="scrollMe.scrollHeight">
                  <!-- <div class="messagewrap suggestions">
                    <div class="messagebody">
                      <ul class="list-inline text-center m-0">
                        <form [formGroup]="chatForm">
                          <li class="list-inline-item">
                            <span (click)="chatForm.controls['message'].setValue('Good Bye'); submitMessage('/bye')">ðŸš€ Good Bye</span>
                          </li>
                          <li class="list-inline-item">
                            <span (click)="chatForm.controls['message'].setValue('Talk To Human'); submitMessage('/transfer')">ðŸ“© Talk To Human</span>
                          </li>
                        </form>
                      </ul>
                    </div>
                  </div> -->
                  <div class="messagewrap e-left" data-first="true">
                    <div class="messagebody">
                      <div class="caption">
                        <div class="name">
                          <div class="e_chat-icon">
                            <img src="../../../../assets/Images/ebot.svg" />
                          </div>
                          enteract.bot
                        </div>
                        <div class="time">{{getCurrentTime()}}</div>
                      </div>
                      <div class="messagebubble">
                        Hi! I'm enteract.bot ðŸ˜Ž Nice to meet you! ðŸ‘‹
                      </div>
                    </div>
                  </div>

                  <ng-container *ngFor="let msg of chatMessages; let i = index">
                    <div
                      class="messagewrap"
                      [ngClass]="{
                        'e-right': msg.type === 'human',
                        'e-left': (msg.type === 'ai-agent' || msg.type == 'human-agent')
                      }"
                      [attr.data-first]="msg.type === 'human' ? true : null"
                      [attr.data-last]="(msg.type === 'ai-agent' || msg.type === 'human-agent') ? true : null"
                    >
                      <div class="messagebody">
                        <div class="caption">
                          <div class="name">
                            <div *ngIf="msg.type === 'ai-agent' || msg.type == 'human-agent'" class="e_chat-icon">
                              <img src="../../../../assets/Images/ebot.svg" />
                            </div>
                            {{ msg.type === "human" ? "You" : msg.type=== "ai-agent" ? "enteract.bot" : "Human Agent"}}
                          </div>
                          <div class="time">
                            {{ msg.timestamp }}

                          </div>
                        </div>
                        <div class="messagebubble">
                          {{ msg.text }}
                        </div>
                      </div>
                    </div>

                  </ng-container>
                  <ng-container>
                    <div *ngIf="typing" class="messagewrap e-left">
                      <div class="messagebody">
                        <div class="caption">
                          <div class="name">
                            <div class="e_chat-icon">
                              <img src="../../../../assets/Images/ebot.svg" />
                            </div>
                            enteract.bot
                          </div>
                          <div class="time">{{ currentTimestamp | date : "shortTime" }}</div>
                        </div>
                        <div class="messagebubble">
                          <div class="typing">
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                <!-- <ng-container *ngFor="let msg of messages; let i = index">
                  <div *ngIf="apiGaveResponse == false"
                  class="messagewrap"
                  [ngClass]="{
                    'e-right': msg.type === 'user',
                    'e-left': (msg.type === 'bot' || msg.type == 'human-agent')
                  }"
                  [attr.data-first]="msg.type === 'user' ? true : null"
                  [attr.data-last]="(msg.type === 'bot' || msg.type === 'human-agent') ? true : null"
                >
                  <div class="messagebody">
                    <div class="caption">
                      <div class="name">
                        <div *ngIf="msg.type === 'bor' || msg.type == 'human-agent'" class="e_chat-icon">
                          <img src="../../../../assets/Images/ebot.svg" />
                        </div>
                        {{ msg.type === "user" ? "You" : "enteract.bot" }}
                      </div>
                      <div class="time">
                        {{ msg.timestamp }}

                      </div>
                    </div>
                    <div class="messagebubble">
                      {{ msg.text }}
                    </div>
                  </div>
                </div>

                  <div *ngIf="typing" class="messagewrap e-left">
                    <div class="messagebody">
                      <div class="caption">
                        <div class="name">
                          <div class="e_chat-icon">
                            <img src="../../../../assets/Images/ebot.svg" />
                          </div>
                          enteract.bot
                        </div>
                        <div class="time">{{ currentTimestamp | date : "shortTime" }}</div>
                      </div>
                      <div class="messagebubble">
                        <div class="typing">
                          <div class="dot"></div>
                          <div class="dot"></div>
                          <div class="dot"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-container> -->

                  <form [formGroup]="chatForm">
                    <ul class="list-inline d-flex align-items-center justify-content-center listbtns">
                      
                        <li class="list-inline-item">
                          <button class="btn btn-white px-3 rounded-pill bg-white " (click)="chatForm.controls['message'].setValue('Good Bye'); submitMessage('/bye')"><i class="fa-solid fa-heart me-2 radical"></i> Good Bye</button>
                        </li>
                        <li class="list-inline-item">
                          <button class="btn btn-white px-3 rounded-pill bg-white "  (click)="chatForm.controls['message'].setValue('Talk To Human'); submitMessage('/transfer')"><i class="fa-regular fa-user me-2 "></i> Talk To Human</button>
                        </li>
                   
                    </ul>
                    
                  </form>
                </section>
                <footer>
                  <form [formGroup]="chatForm">
                    <input
                      class="form-control"
                      placeholder="Send a message.."
                      formControlName="message"
                    />
                    <button
                      class="iconButton iconHover sendicon"
                      (click)="submitMessage('')"
                    >
                      <i class="fa-light fa-paper-plane-top"></i>
                    </button>
                  </form>
                </footer>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</body>
